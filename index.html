<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>WoW | Word World</title>

    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css">

    <link rel="stylesheet" href="style.css">
</head>
<body>

<div id="customAlert">
    <div style="font-size:1.5rem;">🔔</div>
    <div id="alertMsg" style="font-weight:600; font-size:1rem;">메시지 내용</div>
</div>
<div id="streakTooltip"></div>

<div id="wordListModal" class="modal-overlay" style="display: none;" onclick="closeModal(event)">
    <div class="modal-box">
        <h3 id="modalDate" style="font-size: 1.5rem; margin-bottom: 15px; color: var(--primary);">2024-01-01</h3>
        <div style="font-size: 0.9rem; color: var(--text-dim); border-bottom: 1px solid var(--border); padding-bottom: 10px;">학습한 단어 목록</div>
        <div id="modalListContent" class="word-list-scroll"></div>
        <button onclick="document.getElementById('wordListModal').style.display='none'" class="btn-main" style="margin-top:20px; padding:12px;">닫기</button>
    </div>
</div>

<section id="page-auth" class="page" style="display:flex; flex-direction:column; align-items:center; justify-content:center; height:100vh;">
    <h1 style="font-size: 4.5rem; font-weight: 900; color: var(--primary); margin-bottom: 15px; text-shadow: 0 0 30px var(--primary-glow);">WoW</h1>
    <button onclick="login()" class="btn-main" style="max-width: 320px;">Google 계정으로 시작</button>
</section>

<div id="settingsOverlay">
    <div style="max-width: 500px; margin: 0 auto;">
        <h2 style="margin-bottom: 30px; display:flex; align-items:center; gap:10px;"><span style="font-size:1.8rem;">⚙️</span> 설정</h2>

        <div class="setting-row">
            <div>
                <div style="font-weight: 700; font-size: 1.1rem; margin-bottom: 5px;">단어 전환 속도</div>
                <div style="font-size: 0.85rem; color: var(--text-dim);">Preview 단계 자동 넘김</div>
            </div>
            <div class="setting-val">
                <button onclick="adjSetting('previewTime', -0.1)" class="setting-btn">-</button>
                <span id="previewTimeVal" style="min-width:50px; text-align:center; font-weight:800; font-size:1.2rem; font-variant-numeric: tabular-nums;">2.0s</span>
                <button onclick="adjSetting('previewTime', 0.1)" class="setting-btn">+</button>
            </div>
        </div>

        <div class="setting-row">
            <div>
                <div style="font-weight: 700; font-size: 1.1rem; margin-bottom: 5px;">재암기 시간</div>
                <div style="font-size: 0.85rem; color: var(--text-dim);">3단계 뜻 보여주는 시간</div>
            </div>
            <div class="setting-val">
                <button onclick="adjSetting('reLearnTime', -0.5)" class="setting-btn">-</button>
                <span id="reLearnTimeVal" style="min-width:50px; text-align:center; font-weight:800; font-size:1.2rem; font-variant-numeric: tabular-nums;">3.0s</span>
                <button onclick="adjSetting('reLearnTime', 0.5)" class="setting-btn">+</button>
            </div>
        </div>
        <div class="setting-row">
            <div>
                <div style="font-weight: 700; font-size: 1.1rem; margin-bottom: 5px;">하루 학습량</div>
                <div style="font-size: 0.85rem; color: var(--text-dim);">한 번에 학습할 단어 수</div>
            </div>

            <div class="setting-val" style="gap: 5px; padding: 8px 10px;">

                <button onclick="adjSetting('dailyGoal', -10)" class="setting-btn"
                        style="font-size: 0.75rem; color: var(--text-dim); padding: 0 6px;">
                    -10
                </button>

                <button onclick="adjSetting('dailyGoal', -1)" class="setting-btn"
                        style="font-size: 1.4rem; padding: 0 10px; margin-right: 5px;">
                    -
                </button>

                <span id="dailyGoalVal"
                      style="min-width:40px; text-align:center; font-weight:800; font-size:1.3rem; font-variant-numeric: tabular-nums;">
            20
        </span>

                <button onclick="adjSetting('dailyGoal', 1)" class="setting-btn"
                        style="font-size: 1.4rem; padding: 0 10px; margin-left: 5px;">
                    +
                </button>

                <button onclick="adjSetting('dailyGoal', 10)" class="setting-btn"
                        style="font-size: 0.75rem; color: var(--text-dim); padding: 0 6px;">
                    +10
                </button>

            </div>
        </div>

        <button class="btn-main" onclick="toggleSettings()">닫기</button>
    </div>
</div>

<nav class="sidebar" id="sidebar">
    <div style="font-size: 2rem; font-weight: 900; color: var(--primary); margin-bottom: 50px; padding-left: 10px; letter-spacing: -1px;">WoW</div>
    <button class="nav-btn nav-home" onclick="showPage('home')"><span class="icon">🏠</span> 대시보드</button>
    <button class="nav-btn nav-manage" onclick="showPage('manage')"><span class="icon">📁</span> 단어 관리</button>
    <button class="nav-btn" onclick="toggleSettings()"><span class="icon">⚙️</span> 설정</button>
    <button class="nav-btn" onclick="logout()" style="color:var(--error); margin-top:auto;"><span class="icon">🚪</span> 로그아웃</button>
</nav>

<nav class="mobile-nav" id="mobileNav">
    <button class="nav-btn nav-home" onclick="showPage('home')"><span class="icon">🏠</span><span>홈</span></button>
    <button class="nav-btn nav-manage" onclick="showPage('manage')"><span class="icon">📁</span><span>관리</span></button>
    <button class="nav-btn" onclick="toggleSettings()"><span class="icon">⚙️</span><span>설정</span></button>
    <button class="nav-btn" onclick="logout()" style="color:var(--error);"><span class="icon">🚪</span><span>종료</span></button>
</nav>

<main class="main" id="mainArea" style="display:none;">
    <div class="container">
        <section id="page-home" class="page">
            <div id="resumeBanner">
                <div style="font-weight: 800; font-size: 1.1rem;">⚡ 학습 이어하기</div>
                <div style="font-size: 0.9rem; opacity: 0.9;">중단된 시점부터 다시 시작합니다.</div>
            </div>

            <div id="todayTask" class="big-card">
                <div class="count" id="countToday">0</div>
                <div style="font-weight:700; color:var(--text-dim);">오늘의 신규 학습</div>
            </div>
            <div id="reviewTask" class="big-card review">
                <div class="count" id="countReview">0</div>
                <div style="font-weight:700; color:var(--accent);">망각 곡선 복습</div>
            </div>

            <div class="streak-wrap">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px; width: 100%;">
                    <div style="display:flex; align-items:center; gap:10px;justify-content:space-between;width: 100%">
                        <div style="font-size:1rem; font-weight:700; color:var(--text);">학습 기록</div>

                        <div class="period-selector">
                            <div class="period-selector">
                                <button onclick="changePeriod('3M')" id="btn-3M">3개월</button>
                                <button onclick="changePeriod('6M')" id="btn-6M">6개월</button>
                                <button onclick="changePeriod('1Y')" id="btn-1Y">1년</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="gh-container">
                    <div class="gh-labels">
                        <span></span><span>Mon</span><span></span><span>Wed</span><span></span><span>Fri</span><span></span>
                    </div>
                    <div class="streak-scroll-view">
                        <div class="streak-grid" id="streakGrid"></div>
                    </div>
                </div>
            </div>
        </section>

        <section id="page-learn" class="page">
            <div class="learn-view">
                <div id="pBarWrap"><div id="pBar" style="height:100%; background:var(--primary); width:0%;"></div></div>
                <div id="phaseTag" style="position:absolute; top:25px; left:30px; font-weight:800; color:var(--primary); font-size:0.85rem; letter-spacing: 1px;">READY</div>

                <div id="wordArea">
                    <div class="word-text" id="mainWord"></div>
                    <div style="font-size:1.6rem; color:var(--accent); font-weight:700; margin-top:15px; min-height: 2rem;" id="mainMean"></div>
                </div>

                <div id="inputArea" style="display:none; margin-top:20px;">
                    <div id="feedbackMsg" style="margin-bottom:20px; font-weight:800; min-height:24px; font-size: 1.1rem;"></div>
                    <input type="text" id="inWord" class="input-box" placeholder="영어 단어" autocomplete="off">
                    <input type="text" id="inMean" class="input-box" placeholder="뜻 입력" autocomplete="off">
                </div>

                <div style="margin-top: 30px; width: 100%;">
                    <button id="actionBtn" class="btn-main">확인 <span class="pc-hint">(Space)</span></button>
                    <button id="giveUpBtn" class="btn-sub" onclick="handleGiveUp()" style="display:none;">모르겠어요 (넘어가기)</button>
                </div>
            </div>
        </section>

        <section id="page-manage" class="page">
            <div class="learn-view">
                <h3 style="margin-bottom:20px; font-size: 1.5rem;">새 단어장 추가</h3>
                <input type="text" id="setName" class="input-box" placeholder="세트 이름 (예: Day 1)" style="margin-bottom:10px;">
                <textarea id="rawInput" class="input-box" style="height:160px; resize: none; line-height: 1.6;" placeholder="영어단어[Tab]한글뜻&#10;apple	사과&#10;run	달리다"></textarea>
                <button onclick="importWords()" class="btn-main">저장하기</button>

                <div style="margin-top: 40px; border-top: 1px solid var(--border); padding-top: 20px;">
                    <h4 style="margin-bottom: 15px; color: var(--text-dim);">내 단어장 목록</h4>
                    <div id="accordionWrap" style="display: flex; flex-direction: column; gap: 10px;"></div>
                </div>
            </div>
        </section>
    </div>
    <div id="customConfirmModal" class="modal-overlay" style="display: none;">
        <div class="confirm-box">
            <p id="confirmMsg">내용이 들어갑니다</p>
            <div class="confirm-btns">
                <button id="confirmNo" class="btn-cancel">취소</button>
                <button id="confirmYes" class="btn-ok">확인</button>
            </div>
        </div>
    </div>

</main>

<script src="app.js" defer></script>
</body>
</html>